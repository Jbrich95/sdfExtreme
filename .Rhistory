data(Aus_Heat)
Z=Aus_Heat$Temp.
Z_U=Z
chi.emp<-function(U,V,z) sum((U>=z)&(V>=z))/sum(U>=z)
q<-0.98
#Calculate pairwise empirical chi
emp.chi<-matrix(rep(0,dim(Z_U)[2]^2),nrow=dim(Z_U)[2],ncol=dim(Z_U)[2])
for(i in 1:dim(Z_U)[2]){
for(j in 1:i){
emp.chi[i,j]<-chi.emp(Z_U[,i],Z_U[,j],q)
}
}
emp.chi<-emp.chi+t(emp.chi)
diag(emp.chi)<-diag(emp.chi)/2
plot(rdist.earth(Aus_Heat$coords,miles=F),emp.chi,ylab="Chi",xlab="Distance (km)",main="Australian Temperatures")
plot(rdist.earth(Aus_Heat$coords,miles=F),emp.eta,ylab="Eta",xlab="Distance (km)",main="Australian Temperatures")
chi.emp<-function(U,V,z) sum((U>=z)&(V>=z))/sum(U>=z)
q<-0.98
#Calculate pairwise empirical chi
emp.chi<-matrix(rep(0,dim(Z_U)[2]^2),nrow=dim(Z_U)[2],ncol=dim(Z_U)[2])
for(i in 1:dim(Z_U)[2]){
for(j in 1:i){
emp.chi[i,j]<-chi.emp(Z_U[,i],Z_U[,j],q)
}
}
emp.chi<-emp.chi+t(emp.chi)
diag(emp.chi)<-diag(emp.chi)/2
plot(rdist.earth(Aus_Heat$coords,miles=F),emp.chi,ylab="Chi",xlab="Distance (km)",main="Australian Temperatures")
Z
data(Aus_Heat)
Z=Aus_Heat$Temp.
Z_U=Z
unif<-function(x){rank(x)/(length(x)+1)}
for(i in 1:dim(Z_U)[2]){
Z_U[,i]=unif(Z[,i])
}
plot(rdist.earth(Aus_Heat$coords,miles=F),emp.eta,ylab="Eta",xlab="Distance (km)",main="Australian Temperatures")
chi.emp<-function(U,V,z) sum((U>=z)&(V>=z))/sum(U>=z)
q<-0.98
#Calculate pairwise empirical chi
emp.chi<-matrix(rep(0,dim(Z_U)[2]^2),nrow=dim(Z_U)[2],ncol=dim(Z_U)[2])
for(i in 1:dim(Z_U)[2]){
for(j in 1:i){
emp.chi[i,j]<-chi.emp(Z_U[,i],Z_U[,j],q)
}
}
emp.chi<-emp.chi+t(emp.chi)
diag(emp.chi)<-diag(emp.chi)/2
plot(rdist.earth(Aus_Heat$coords,miles=F),emp.chi,ylab="Chi",xlab="Distance (km)",main="Australian Temperatures")
q<-0.95
#Calculate pairwise empirical chi
emp.chi<-matrix(rep(0,dim(Z_U)[2]^2),nrow=dim(Z_U)[2],ncol=dim(Z_U)[2])
for(i in 1:dim(Z_U)[2]){
for(j in 1:i){
emp.chi[i,j]<-chi.emp(Z_U[,i],Z_U[,j],q)
}
}
emp.chi<-emp.chi+t(emp.chi)
diag(emp.chi)<-diag(emp.chi)/2
plot(rdist.earth(Aus_Heat$coords,miles=F),emp.chi,ylab="Chi",xlab="Distance (km)",main="Australian Temperatures")
q<-0.99
#Calculate pairwise empirical chi
emp.chi<-matrix(rep(0,dim(Z_U)[2]^2),nrow=dim(Z_U)[2],ncol=dim(Z_U)[2])
for(i in 1:dim(Z_U)[2]){
for(j in 1:i){
emp.chi[i,j]<-chi.emp(Z_U[,i],Z_U[,j],q)
}
}
emp.chi<-emp.chi+t(emp.chi)
diag(emp.chi)<-diag(emp.chi)/2
plot(rdist.earth(Aus_Heat$coords,miles=F),emp.chi,ylab="Chi",xlab="Distance (km)",main="Australian Temperatures")
dim(Z)
q<-0.995
#Calculate pairwise empirical chi
emp.chi<-matrix(rep(0,dim(Z_U)[2]^2),nrow=dim(Z_U)[2],ncol=dim(Z_U)[2])
for(i in 1:dim(Z_U)[2]){
for(j in 1:i){
emp.chi[i,j]<-chi.emp(Z_U[,i],Z_U[,j],q)
}
}
emp.chi<-emp.chi+t(emp.chi)
diag(emp.chi)<-diag(emp.chi)/2
plot(rdist.earth(Aus_Heat$coords,miles=F),emp.chi,ylab="Chi",xlab="Distance (km)",main="Australian Temperatures")
data("High_Precip")
Eta.HillEst=function(x.exp,y.exp,p){
XY=cbind(x.exp,y.exp)
temp=apply(XY,1,min,na.rm=T)
t=quantile(temp,prob=p,na.rm=T)
temp2=temp[temp>t]
temp2=temp2[is.finite(temp2)]
eta=sum(temp2-t)/length(temp2)
return(eta)
}
data("High_Precip")
Z=High_Precip$PR.
Z_U=Z
unif<-function(x){rank(x)/(length(x)+1)}
for(i in 1:dim(Z_U)[2]){
Z_U[,i]=unif(Z[,i])
}
Z_Exp=qexp(Z_U,1)
p=0.98
emp.eta=matrix(rep(0,dim(Z)[2]^2),nrow=dim(Z)[2],ncol=dim(Z)[2])
for(i in 1:dim(Z)[2]){
for(j in 1:i){
emp.eta[i,j]=Eta.HillEst(Z_Exp[,i],Z_Exp[,j],p)
}
print(i)
}
emp.eta=emp.eta+t(emp.eta)
diag(emp.eta)=diag(emp.eta)/2
plot(rdist.earth(Aus_Heat$coords,miles=F),emp.eta,ylab="Eta",xlab="Distance (km)",main="Australian Temperatures")
chi.emp<-function(U,V,z) sum((U>=z)&(V>=z))/sum(U>=z)
q<-0.995
#Calculate pairwise empirical chi
emp.chi<-matrix(rep(0,dim(Z_U)[2]^2),nrow=dim(Z_U)[2],ncol=dim(Z_U)[2])
for(i in 1:dim(Z_U)[2]){
for(j in 1:i){
emp.chi[i,j]<-chi.emp(Z_U[,i],Z_U[,j],q)
}
}
emp.chi<-emp.chi+t(emp.chi)
diag(emp.chi)<-diag(emp.chi)/2
plot(rdist.earth(Aus_Heat$coords,miles=F),emp.chi,ylab="Chi",xlab="Distance (km)",main="Australian Temperatures")
chi.emp<-function(U,V,z) sum((U>=z)&(V>=z))/sum(U>=z)
q<-0.995
#Calculate pairwise empirical chi
emp.chi<-matrix(rep(0,dim(Z_U)[2]^2),nrow=dim(Z_U)[2],ncol=dim(Z_U)[2])
for(i in 1:dim(Z_U)[2]){
for(j in 1:i){
emp.chi[i,j]<-chi.emp(Z_U[,i],Z_U[,j],q)
}
}
emp.chi<-emp.chi+t(emp.chi)
diag(emp.chi)<-diag(emp.chi)/2
plot(rdist.earth(Aus_Heat$coords,miles=F),emp.chi,ylab="Chi",xlab="Distance (km)",main="Australian Temperatures")
plot(rdist.earth(High_Precip$coords,miles=F),emp.chi,ylab="Chi",xlab="Distance (km)",main="Australian Temperatures")
q<-0.95
#Calculate pairwise empirical chi
emp.chi<-matrix(rep(0,dim(Z_U)[2]^2),nrow=dim(Z_U)[2],ncol=dim(Z_U)[2])
for(i in 1:dim(Z_U)[2]){
for(j in 1:i){
emp.chi[i,j]<-chi.emp(Z_U[,i],Z_U[,j],q)
}
}
emp.chi<-emp.chi+t(emp.chi)
diag(emp.chi)<-diag(emp.chi)/2
plot(rdist.earth(High_Precip$coords,miles=F),emp.chi,ylab="Chi",xlab="Distance (km)",main="Australian Temperatures")
q<-0.99
#Calculate pairwise empirical chi
emp.chi<-matrix(rep(0,dim(Z_U)[2]^2),nrow=dim(Z_U)[2],ncol=dim(Z_U)[2])
for(i in 1:dim(Z_U)[2]){
for(j in 1:i){
emp.chi[i,j]<-chi.emp(Z_U[,i],Z_U[,j],q)
}
}
emp.chi<-emp.chi+t(emp.chi)
diag(emp.chi)<-diag(emp.chi)/2
plot(rdist.earth(High_Precip$coords,miles=F),emp.chi,ylab="Chi",xlab="Distance (km)",main="Australian Temperatures")
dim(Z)
q<-0.975
#Calculate pairwise empirical chi
emp.chi<-matrix(rep(0,dim(Z_U)[2]^2),nrow=dim(Z_U)[2],ncol=dim(Z_U)[2])
for(i in 1:dim(Z_U)[2]){
for(j in 1:i){
emp.chi[i,j]<-chi.emp(Z_U[,i],Z_U[,j],q)
}
}
emp.chi<-emp.chi+t(emp.chi)
diag(emp.chi)<-diag(emp.chi)/2
plot(rdist.earth(High_Precip$coords,miles=F),emp.chi,ylab="Chi",xlab="Distance (km)",main="Australian Temperatures")
q<-0.98
#Calculate pairwise empirical chi
emp.chi<-matrix(rep(0,dim(Z_U)[2]^2),nrow=dim(Z_U)[2],ncol=dim(Z_U)[2])
for(i in 1:dim(Z_U)[2]){
for(j in 1:i){
emp.chi[i,j]<-chi.emp(Z_U[,i],Z_U[,j],q)
}
}
emp.chi<-emp.chi+t(emp.chi)
diag(emp.chi)<-diag(emp.chi)/2
plot(rdist.earth(High_Precip$coords,miles=F),emp.chi,ylab="Chi",xlab="Distance (km)",main="Australian Temperatures")
plot(rdist.earth(High_Precip$coords,miles=F),emp.chi,ylim=c(0,1),ylab="Chi",xlab="Distance (km)",main="Australian Temperatures")
#Calculate pairwise empirical chi
emp.chi2<-matrix(rep(0,dim(Z_U)[2]^2),nrow=dim(Z_U)[2],ncol=dim(Z_U)[2])
for(i in 1:dim(Z_U)[2]){
for(j in 1:i){
emp.chi2[i,j]<-chi.emp(Z_U[,i],Z_U[,j],q)
}
}
emp.chi2<-emp.chi2+t(emp.chi2)
diag(emp.chi2)<-diag(emp.chi2)/2
plot(rdist.earth(High_Precip$coords,miles=F),emp.chi,ylim=c(0,1),ylab="Chi",xlab="Distance (km)",main="Australian Temperatures")
plot(rdist.earth(High_Precip$coords,miles=F),emp.chi2,ylim=c(0,1),ylab="Chi",xlab="Distance (km)",main="Australian Temperatures")
par(mfrow=c(2,2))
plot(rdist.earth(High_Precip$coords,miles=F),emp.chi,ylim=c(0,1),ylab="Chi",xlab="Distance (km)",main="Australian Temperatures")
plot(rdist.earth(High_Precip$coords,miles=F),emp.chi2,ylim=c(0,1),ylab="Chi",xlab="Distance (km)",main="Australian Temperatures")
par(mfrow=c(2,1))
plot(rdist.earth(High_Precip$coords,miles=F),emp.chi,ylim=c(0,1),ylab="Chi",xlab="Distance (km)",main="Australian Temperatures")
plot(rdist.earth(High_Precip$coords,miles=F),emp.chi2,ylim=c(0,1),ylab="Chi",xlab="Distance (km)",main="Australian Temperatures")
par(mfrow=c(1,2))
plot(rdist.earth(High_Precip$coords,miles=F),emp.chi,ylim=c(0,1),ylab="Chi",xlab="Distance (km)",main="Australian Temperatures")
plot(rdist.earth(High_Precip$coords,miles=F),emp.chi2,ylim=c(0,1),ylab="Chi",xlab="Distance (km)",main="Australian Temperatures")
chi.emp<-function(U,V,z) sum((U>=z)&(V>=z))/sum(U>=z)
q<-0.95
#Calculate pairwise empirical chi
emp.chi<-matrix(rep(0,dim(Z_U)[2]^2),nrow=dim(Z_U)[2],ncol=dim(Z_U)[2])
for(i in 1:dim(Z_U)[2]){
for(j in 1:i){
emp.chi[i,j]<-chi.emp(Z_U[,i],Z_U[,j],q)
}
}
emp.chi<-emp.chi+t(emp.chi)
diag(emp.chi)<-diag(emp.chi)/2
q<-0.98
#Calculate pairwise empirical chi
emp.chi2<-matrix(rep(0,dim(Z_U)[2]^2),nrow=dim(Z_U)[2],ncol=dim(Z_U)[2])
for(i in 1:dim(Z_U)[2]){
for(j in 1:i){
emp.chi2[i,j]<-chi.emp(Z_U[,i],Z_U[,j],q)
}
}
emp.chi2<-emp.chi2+t(emp.chi2)
diag(emp.chi2)<-diag(emp.chi2)/2
plot(rdist.earth(High_Precip$coords,miles=F),emp.chi,ylim=c(0,1),ylab="Chi",xlab="Distance (km)",main="Australian Temperatures")
plot(rdist.earth(High_Precip$coords,miles=F),emp.chi2,ylim=c(0,1),ylab="Chi",xlab="Distance (km)",main="Australian Temperatures")
q<-0.99
#Calculate pairwise empirical chi
emp.chi2<-matrix(rep(0,dim(Z_U)[2]^2),nrow=dim(Z_U)[2],ncol=dim(Z_U)[2])
for(i in 1:dim(Z_U)[2]){
for(j in 1:i){
emp.chi2[i,j]<-chi.emp(Z_U[,i],Z_U[,j],q)
}
}
emp.chi2<-emp.chi2+t(emp.chi2)
diag(emp.chi2)<-diag(emp.chi2)/2
plot(rdist.earth(High_Precip$coords,miles=F),emp.chi,ylim=c(0,1),ylab="Chi",xlab="Distance (km)",main="Australian Temperatures")
plot(rdist.earth(High_Precip$coords,miles=F),emp.chi2,ylim=c(0,1),ylab="Chi",xlab="Distance (km)",main="Australian Temperatures")
dim(Z)
3600*0.01
q<-0.98
#Calculate pairwise empirical chi
emp.chi2<-matrix(rep(0,dim(Z_U)[2]^2),nrow=dim(Z_U)[2],ncol=dim(Z_U)[2])
for(i in 1:dim(Z_U)[2]){
for(j in 1:i){
emp.chi2[i,j]<-chi.emp(Z_U[,i],Z_U[,j],q)
}
}
emp.chi2<-emp.chi2+t(emp.chi2)
diag(emp.chi2)<-diag(emp.chi2)/2
plot(rdist.earth(High_Precip$coords,miles=F),emp.chi,ylim=c(0,1),ylab="Chi",xlab="Distance (km)",main="Australian Temperatures")
plot(rdist.earth(High_Precip$coords,miles=F),emp.chi2,ylim=c(0,1),ylab="Chi",xlab="Distance (km)",main="Australian Temperatures")
data("Snow_Precip")
Eta.HillEst=function(x.exp,y.exp,p){
XY=cbind(x.exp,y.exp)
temp=apply(XY,1,min,na.rm=T)
t=quantile(temp,prob=p,na.rm=T)
temp2=temp[temp>t]
temp2=temp2[is.finite(temp2)]
eta=sum(temp2-t)/length(temp2)
return(eta)
}
data("Snow_Precip")
Z=Snow_Precip$PR.
Z_U=Z
unif<-function(x){rank(x)/(length(x)+1)}
for(i in 1:dim(Z_U)[2]){
Z_U[,i]=unif(Z[,i])
}
chi.emp<-function(U,V,z) sum((U>=z)&(V>=z))/sum(U>=z)
q<-0.95
#Calculate pairwise empirical chi
emp.chi<-matrix(rep(0,dim(Z_U)[2]^2),nrow=dim(Z_U)[2],ncol=dim(Z_U)[2])
for(i in 1:dim(Z_U)[2]){
for(j in 1:i){
emp.chi[i,j]<-chi.emp(Z_U[,i],Z_U[,j],q)
}
}
emp.chi<-emp.chi+t(emp.chi)
diag(emp.chi)<-diag(emp.chi)/2
q<-0.98
#Calculate pairwise empirical chi
emp.chi2<-matrix(rep(0,dim(Z_U)[2]^2),nrow=dim(Z_U)[2],ncol=dim(Z_U)[2])
for(i in 1:dim(Z_U)[2]){
for(j in 1:i){
emp.chi2[i,j]<-chi.emp(Z_U[,i],Z_U[,j],q)
}
}
emp.chi2<-emp.chi2+t(emp.chi2)
diag(emp.chi2)<-diag(emp.chi2)/2
plot(rdist.earth(Snow_Precip$coords,miles=F),emp.chi,ylim=c(0,1),ylab="Chi",xlab="Distance (km)",main="Australian Temperatures")
plot(rdist.earth(Snow_Precip$coords,miles=F),emp.chi2,ylim=c(0,1),ylab="Chi",xlab="Distance (km)",main="Australian Temperatures")
Z
data("Snow_Precip")
Z=Snow_Precip$PR.
Z
Z=Snow_Precip$Pr.
Z_U=Z
unif<-function(x){rank(x)/(length(x)+1)}
for(i in 1:dim(Z_U)[2]){
Z_U[,i]=unif(Z[,i])
}
chi.emp<-function(U,V,z) sum((U>=z)&(V>=z))/sum(U>=z)
q<-0.95
#Calculate pairwise empirical chi
emp.chi<-matrix(rep(0,dim(Z_U)[2]^2),nrow=dim(Z_U)[2],ncol=dim(Z_U)[2])
for(i in 1:dim(Z_U)[2]){
for(j in 1:i){
emp.chi[i,j]<-chi.emp(Z_U[,i],Z_U[,j],q)
}
}
emp.chi<-emp.chi+t(emp.chi)
diag(emp.chi)<-diag(emp.chi)/2
q<-0.98
#Calculate pairwise empirical chi
emp.chi2<-matrix(rep(0,dim(Z_U)[2]^2),nrow=dim(Z_U)[2],ncol=dim(Z_U)[2])
for(i in 1:dim(Z_U)[2]){
for(j in 1:i){
emp.chi2[i,j]<-chi.emp(Z_U[,i],Z_U[,j],q)
}
}
emp.chi2<-emp.chi2+t(emp.chi2)
diag(emp.chi2)<-diag(emp.chi2)/2
plot(rdist.earth(Snow_Precip$coords,miles=F),emp.chi,ylim=c(0,1),ylab="Chi",xlab="Distance (km)",main="Australian Temperatures")
plot(rdist.earth(Snow_Precip$coords,miles=F),emp.chi2,ylim=c(0,1),ylab="Chi",xlab="Distance (km)",main="Australian Temperatures")
q<-0.99
#Calculate pairwise empirical chi
emp.chi2<-matrix(rep(0,dim(Z_U)[2]^2),nrow=dim(Z_U)[2],ncol=dim(Z_U)[2])
for(i in 1:dim(Z_U)[2]){
for(j in 1:i){
emp.chi2[i,j]<-chi.emp(Z_U[,i],Z_U[,j],q)
}
}
emp.chi2<-emp.chi2+t(emp.chi2)
diag(emp.chi2)<-diag(emp.chi2)/2
plot(rdist.earth(Snow_Precip$coords,miles=F),emp.chi,ylim=c(0,1),ylab="Chi",xlab="Distance (km)",main="Australian Temperatures")
plot(rdist.earth(Snow_Precip$coords,miles=F),emp.chi2,ylim=c(0,1),ylab="Chi",xlab="Distance (km)",main="Australian Temperatures")
q<-0.96
#Calculate pairwise empirical chi
emp.chi2<-matrix(rep(0,dim(Z_U)[2]^2),nrow=dim(Z_U)[2],ncol=dim(Z_U)[2])
for(i in 1:dim(Z_U)[2]){
for(j in 1:i){
emp.chi2[i,j]<-chi.emp(Z_U[,i],Z_U[,j],q)
}
}
emp.chi2<-emp.chi2+t(emp.chi2)
diag(emp.chi2)<-diag(emp.chi2)/2
plot(rdist.earth(Snow_Precip$coords,miles=F),emp.chi,ylim=c(0,1),ylab="Chi",xlab="Distance (km)",main="Australian Temperatures")
plot(rdist.earth(Snow_Precip$coords,miles=F),emp.chi2,ylim=c(0,1),ylab="Chi",xlab="Distance (km)",main="Australian Temperatures")
q<-0.975
#Calculate pairwise empirical chi
emp.chi2<-matrix(rep(0,dim(Z_U)[2]^2),nrow=dim(Z_U)[2],ncol=dim(Z_U)[2])
for(i in 1:dim(Z_U)[2]){
for(j in 1:i){
emp.chi2[i,j]<-chi.emp(Z_U[,i],Z_U[,j],q)
}
}
emp.chi2<-emp.chi2+t(emp.chi2)
diag(emp.chi2)<-diag(emp.chi2)/2
plot(rdist.earth(Snow_Precip$coords,miles=F),emp.chi,ylim=c(0,1),ylab="Chi",xlab="Distance (km)",main="Australian Temperatures")
plot(rdist.earth(Snow_Precip$coords,miles=F),emp.chi2,ylim=c(0,1),ylab="Chi",xlab="Distance (km)",main="Australian Temperatures")
data(Aus_Heat)
Z<-Aus_Heat$Temp.
Gcoords<-Aus_Heat$coords
data(Aus_Heat_Output)
sdf<-Aus_Heat_Output$sdf
likG.MSP<-Aus_Heat_Output$likG.MSP
likD.MSP<-Aus_Heat_Output$likD.MSP
Dcoords<-returnDcoord(sdf$par,Gcoords,sdf$m.ind,sphere.dis=TRUE)
library(sdfEXTREME)
Dcoords<-returnDcoord(sdf$par,Gcoords,sdf$m.ind,sphere.dis=TRUE)
unif<-function(x) rank(x)/(length(x)+1)
Z_U<-Z
for(i in 1:dim(Z_U)[2]) Z_U[,i]<-unif(Z[,i]) # Transform to uniform margins
Z_Exp<-qexp(Z_U) #Transform to exponential margins
q <- 0.98 # 98% quantile used as threshold in composite likelihood
u <- quantile(Z_Exp,prob=q)
q <- 0.98 # 98% quantile used as threshold in composite likelihood
u <- quantile(Z_Exp,prob=q)
s_G_IMSP <- Score_Est_Smith(Z_Exp,u,coord=Gcoords,lik=likG.IMSP,type="InvSmith")
dim(Z)
Score_Est_Smith=Score_Est_1D
Z=Z[1:10,]
s_G_IMSP <- Score_Est_Smith(Z_Exp,u,coord=Gcoords,lik=likG.IMSP,type="InvSmith")
likG.IMSP<-Aus_Heat_Output$likG.IMSP
likD.IMSP<-Aus_Heat_Output$likD.IMSP
s_G_IMSP <- Score_Est_Smith(Z_Exp,u,coord=Gcoords,lik=likG.IMSP,type="InvSmith")
warnings()
s_G_IMSP <- Score_Est_Smith(Z_Exp[1:10,],u,coord=Gcoords,lik=likG.IMSP,type="InvSmith")
s_G_IMSP
s_D_IMSP=s_G_IMSP
#Estimate variance of score - This is specfic to the Australian summer temperatures data.
block.sizes <- c(91,90) #Set block.size # Here we take 90 and 91, corresponding to a regular season
#and a season with a leap year
years <- 1957:2014
k <- length(years)
temp <- matrix(0,nrow=k,ncol=1)
temp2 <- matrix(0,nrow=k,ncol=1)
int <- 0
for(l in 1:k){
if(years[l]%%4==0) block.size=block.sizes[1] else block.size=block.sizes[2]
int <- int + block.size
temp[l] <- sum(s_G_IMSP[(int-block.size+1):(int)])
temp2[l] <- sum(s_D_IMSP[(int-block.size+1):(int)])
}
temp
temp=sum(s_G_IMSP)
temp2=sum(s_G_IMSP)
varS_G_IMSP <- var(temp)
varS_D_IMSP <- var(temp2)
varS_G_IMSP
temp
varS_G_IMSP=1
varS_D_IMSP=1
#Estimate Clic
CLIC_G_IMSP <-2*likG.IMSP$value+2*sum(diag(varS_G_IMSP%*%solve(likG.IMSP$hessian)))
CLIC_D_IMSP <- 2*likD.IMSP$value+2*sum(diag(varS_D_IMSP%*%solve(likD.IMSP$hessian)))
CLIC_G_IMSP
CLIC_D_IMSP
likD.IMSP
likD.MSP
likG.IMSP
devtools::document()
devtools::document()
devtools::document()
devtools::document()
devtools::document()
library(sdfEXTREME)
detach("package:sdfEXTREME", unload = TRUE)
library(sdfEXTREME)
devtools::document()
data(Aus_Heat)
Z<-Aus_Heat$Temp.
Gcoords<-Aus_Heat$coords
data(Aus_Heat_Output)
sdf<-Aus_Heat_Output$sdf
likG.MSP<-Aus_Heat_Output$likG.MSP
likD.MSP<-Aus_Heat_Output$likD.MSP
Dcoords<-returnDcoord(sdf$par,Gcoords,sdf$m.ind,sphere.dis=TRUE)
unif<-function(x) rank(x)/(length(x)+1)
Z_U<-Z
for(i in 1:dim(Z_U)[2]) Z_U[,i]<-unif(Z[,i]) # Transform to uniform margins
Z_Exp<-qexp(Z_U) #Transform to exponential margins
q <- 0.98 # 98% quantile used as threshold in composite likelihood
u <- quantile(Z_Exp,prob=q)
likG.IMSP<-Aus_Heat_Output$likG.IMSP
likD.IMSP<-Aus_Heat_Output$likD.IMSP
q <- 0.98 # 98% quantile used as threshold in composite likelihood
u <- quantile(Z_Exp,prob=q)
s_G_IMSP <- Score_Est_Smith(Z_Exp,u,coord=Gcoords,lik=likG.IMSP,type="InvSmith",sphere.dis=T)
Z_Exp=Z_Exp[1:10,]
s_G_IMSP <- Score_Est_Smith(Z_Exp,u,coord=Gcoords,lik=likG.IMSP,type="InvSmith",sphere.dis=T)
s_D_IMSP <- Score_Est_Smith(Z_Exp,u,coord=Dcoords,lik=likD.IMSP,type="InvSmith",sphere.dis=T)
s_G_IMSP
s_D_IMSP
Z_Exp
u
#Estimate variance of score - This is specfic to the Australian summer temperatures data.
block.sizes <- c(91,90) #Set block.size # Here we take 90 and 91, corresponding to a regular season
#and a season with a leap year
years <- 1957:2014
k <- length(years)
temp <- matrix(0,nrow=k,ncol=1)
temp2 <- matrix(0,nrow=k,ncol=1)
int <- 0
for(l in 1:k){
if(years[l]%%4==0) block.size=block.sizes[1] else block.size=block.sizes[2]
int <- int + block.size
temp[l] <- sum(s_G_IMSP[(int-block.size+1):(int)])
temp2[l] <- sum(s_D_IMSP[(int-block.size+1):(int)])
}
varS_G_IMSP <- var(temp)
varS_D_IMSP <- var(temp2)
#Estimate Clic
CLIC_G_IMSP <-2*likG.IMSP$value+2*sum(diag(varS_G_IMSP%*%solve(likG.IMSP$hessian)))
CLIC_D_IMSP <- 2*likD.IMSP$value+2*sum(diag(varS_D_IMSP%*%solve(likD.IMSP$hessian)))
CLIC_G_IMSP
CLIC_D_IMSP
likG.IMSP
varS_G_IMSP
library(sdfEXTREME)
data("Aus_Heat")
Aus_Heat$Temp.
?rdist
devtools::document()
devtools::document()
devtools::document()
devtools::document()
devtools::document()
devtools::document()
devtools::document()
devtools::document()
devtools::document()
devtools::document()
devtools::document()
devtools::document()
devtools::document()
devtools::document()
library(sdfEXTREME)
devtools::build_manual()
devtools::document()
library(sdfEXTREME)
devtools::build_manual()
devtools::document()
devtools::build_manual()
library(sdfEXTREME)
devtools::document()
devtools::build_manual()
library(sdfEXTREME)
devtools::document()
devtools::build_manual()
library(sdfEXTREME)
